# Squid proxy configuration for cc-gtd domain allowlist

# Listen on port 3128
http_port 3128

# Domain allowlist ACL
acl allowed_domains dstdomain "/etc/squid/allowed-domains.txt"

# Allowed ports for CONNECT tunnels
acl SSL_ports port 443
acl SSL_ports port 993
acl CONNECT method CONNECT

# Local network (Docker internal)
acl localnet src 10.0.0.0/8
acl localnet src 172.16.0.0/12
acl localnet src 192.168.0.0/16

# Access rules
http_access allow localnet CONNECT SSL_ports allowed_domains
http_access allow localnet allowed_domains
http_access deny all

# No caching â€” we're a security proxy, not a performance proxy
cache deny all

# Logging to /var/log/squid (proxy user has write access)
access_log stdio:/var/log/squid/access.log
cache_log /var/log/squid/cache.log

# PID file location
pid_filename /var/run/squid/squid.pid
